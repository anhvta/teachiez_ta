!function(r){var a=function(){var e=localStorage.getItem("sessionId");if(e)return e;e=function(){var n=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=(n+16*Math.random())%16|0;return n=Math.floor(n/16),("x"==e?t:3&t|8).toString(16)})}();return localStorage.setItem("sessionId",e),e}(),o=null,i="https://chun.website/api/v1/",n="crmModalContainer",c=null,s=null;let t=!0;var l=864e5,u=null,d=null;function p(e,t,n){o?(e={session:a,event_type:e,event_values:t,path:r.location.pathname,url:r.location.href,referrer:document.referrer,device:function(){var e=navigator.userAgent;{if(/android/i.test(e))return"Android";if(/iPad|iPhone|iPod/.test(e)&&!r.MSStream)return"iOS";if(/windows phone/i.test(e))return"Windows Phone";if(/Macintosh|MacIntel|MacPPC|Mac68K/.test(e))return"Mac";if(/Windows|Win32|Win64|WOW64/.test(e))return"Windows";if(/Linux/i.test(e))return"Linux"}return"Unknown"}(),ip:h(),element_classes:n,popup:s},(t=new XMLHttpRequest).open("POST",i+"track",!0),t.setRequestHeader("Content-Type","application/json"),t.setRequestHeader("x-api-key",o),t.send(JSON.stringify(e))):console.error("Teachiez API is not set")}function m(e,t,n){t={value:t,expiry:(new Date).getTime()+n};localStorage.setItem(e,JSON.stringify(t))}function f(e){var t=localStorage.getItem(e);return t?(t=JSON.parse(t),(new Date).getTime()>t.expiry?(localStorage.removeItem(e),0):t.value):0}function h(){var e=f("crm_ip");return 0!=e?e:(fetch("https://api.ipify.org?format=json").then(e=>e.json()).then(e=>m("crm_ip",e.ip,l)).catch(e=>console.error(e)),f("crm_ip"))}function v(){var t=f("crm_start_time");t||m("crm_start_time",t=(new Date).getTime(),l/24),u=setInterval(()=>{var e=(new Date).getTime(),e=Math.floor((e-t)/1e3);console.log(e),null!=c&&c<=e&&(localStorage.removeItem("crm_start_time"),clearInterval(u),null!=s)&&(e={session:a,url:r.location.href,popup:s,ip:h()},fetch(i+"ping",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json","x-api-key":o}}).then(e=>e.json()).then(e=>{if(void 0!==e.data)try{var t=document.createElement("div");t.setAttribute("id",n),t.innerHTML=e.data.content,document.body.appendChild(t),jQuery("#crm-banner-modal").modal("show"),g(),y(),clearInterval(u),clearInterval(d)}catch(e){console.error(e)}}).catch(e=>console.error(e)))},1e3)}function x(){var e;t&&(e={session:a,url:r.location.href,ip:h()},fetch(i+"popups",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json","x-api-key":o}}).then(e=>e.json()).then(e=>{clearInterval(d),clearInterval(u),t=!1,void 0!==e.data?(c=e.data.popup.duration,e.data.popup.click,s=e.data.popup.id,m("crm_popup_pending",1,1e3*e.data.popup.pending_duration),v()):(s=c=null,d=setInterval(()=>{t=!0,localStorage.removeItem("crm_start_time"),x()},1e4))}).catch(e=>console.error(e)))}function g(){for(var e=document.getElementsByTagName("a"),t=0;t<e.length;t++)e[t].addEventListener("click",function(){p("event_click",this.getAttribute("href"),Array.from(this.classList));try{jQuery("#crm-banner-modal").modal("hide")}catch(e){}})}function y(){document.querySelectorAll("button").forEach(n=>{n.addEventListener("click",function(e){0;var t=n.dataset;p("event_click",Object.fromEntries(Object.entries(t)),Array.from(e.target.classList));try{jQuery("#crm-banner-modal").modal("hide")}catch(e){}})})}r.Teachiez_TA?console.warn("Teachiez_TA is already loaded."):(h(),r.addEventListener("load",function(){p("event_view","first visit",""),v(),x(),g(),y(),document.querySelectorAll("form").forEach(e=>{e.addEventListener("submit",function(){var e,t={};for(e of new FormData(this).entries())t[e[0]]=e[1];p("event_submission",t,"")})})}),r.Teachiez_TA={setApiKey:function(e){o=e},version:"1.1.1",trackEvent:p})}(window);